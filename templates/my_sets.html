{% extends "layout.html" %}

{% block title %}Requirement Sets{% endblock %}

{% block content %}
    <h1>My Requirement Sets</h1>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
       <div class="flash-messages">
        {% for message in messages %}
        <div class="flash">{{ message }}</div>
        {% endfor %}
       </div>
    {% endif %}
    {% endwith %}

    <!-- Form to create a new set -->
    <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div>
            <input type="text" name="new_set_name" placeholder="New set name" autocomplete="off" required>
        </div>
        <button type="submit">Create Set</button>
    </form>

    <hr>
    <h2>Your Sets</h2>
    <!-- Display existing sets -->
    {% if doc_sets %}
        {% for set in doc_sets|reverse %}
            <div style="margin-bottom: 20px;">
                <h3>{{ set.name }}</h3>

                <p><strong>Required Documents:</strong></p>
                <ul>
                    {% for doc in docs_by_set[set.id] %}
                        <li>{{ doc.doc_type }}</li>
                    {% else %}
                        <li><em>No documents assigned yet</em></li>
                    {% endfor %}
                </ul>

                <!-- Link to edit the set -->
                <a href="{{ url_for('edit_set', set_id=set.id) }}">
                    <button type="button">Edit</button>
                </a>
            </div>
            <hr>
        {% endfor %}
    {% else %}
        <p>No sets yet.</p>
    {% endif %}

{% endblock %}