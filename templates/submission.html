<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Submit Required Documents</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <nav style="background-color: #f0f0f0; padding: 10px;">
        <a href="/submitter_dashboard" style="margin-right: 15px;">Dashboard</a>
        <a href="/logout">Log Out</a>
    </nav>

    <h2>Documents Submission</h2>
    <h3>Submission Title: {{ doc_request["name"] }}</h3>
    <h3>Project: {{ project_name["project_name"] }}</h3>
    <p><strong>Description:</strong> {{ doc_request["description"] }}</p>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
        <div class="flash-messages">
            {% for message in messages %}
                <div class="flash">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}
    {% endwith %}

    <form method="post" action="/submission/{{ doc_request['token'] }}" enctype="multipart/form-data">
        {% for doc in required_docs %}
        <div class="doc-block">
            <strong>{{ doc["doc_type"] }}</strong><br>
            {% set status = doc["doc_status"] if "doc_status" in doc else "MISSING" %}
            Status: {{ status.replace("_", " ").title() }}

            {% if doc["link"] %}
                <div>
                    Current file: <a href="{{ doc["link"] }}" target="_blank">View submitted</a>
                    <form method="post" action="/delete_doc/{{ doc['id'] }}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this file?');">
                        <button type="submit">Delete</button>
                    </form>
                </div>
            {% endif %}

            {% if not doc["link"] or doc["doc_status"] == "action_required" %}
                <input type="file" name="{{ doc['doc_type'] }}"><br>
                <label>Expiry Date (if applicable):</label>
                <input type="date" name="{{ doc['doc_type'] }}_expiry"><br>
                <input type="hidden" name="doc_id_{{ doc['doc_type'] }}" value="{{ doc['id'] }}">
            {% else %}
                <div class="locked">Submission locked â€” already submitted</div>
            {% endif %}
        </div>
        {% endfor %}

        <button type="submit">Submit All</button>
    </form>

</body>
</html>



